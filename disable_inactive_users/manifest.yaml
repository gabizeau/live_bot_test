# Built-in Sonrai Bot: srn:supersonrai::bot/e890f06e-82dc-4a7f-9b24-133f83c31579
version: 2022-06-27
type: Remediation
title: Disable Inactive Users
operation: EXECUTE_PYTHON_SCRIPT
authorName: Sonrai Security
cloud: AWS
authorEmail: info@sonraisecurity.com
requiredPermissions: |-
  No permissions needed

# one or more fields must be specified
description: "This template allows you to setup a bot to disable inactive users"

fields:
  - name: "Never Disable These Users"
    required: true 
    type: "select"
    multi: true
    select:
      search: '{SonraiUsers(where: { isActive: true }) {items {email}}}'
      path: ["data", "SonraiUsers", "items"]
      valueField: "email"
      labelFields: ["email"]

  - name: "Disable in-active users after this many days"
    required: true
    type: "text"
    multi: false

  - name: "Keep Sonrai-Security Users"
    required: true
    type: "checkbox"